<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Portafolio - FideFondos DeFi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-navy: #0B1426;
            --warm-gold: #D4AF37;
            --soft-blue: #4A90E2;
            --light-gray: #F8F9FA;
            --medium-gray: #6C757D;
            --success-green: #28A745;
            --warning-amber: #FFC107;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--primary-navy) 0%, #1A2332 100%);
            color: white;
            overflow-x: hidden;
        }
        
        .glass-effect {
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--warm-gold) 0%, var(--soft-blue) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--warm-gold) 0%, #B8941F 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
        }
        
        .portfolio-card {
            background: rgba(255, 255, 255, 0.05);
            -webkit-backdrop-filter: blur(10px); /* Para Safari */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .portfolio-card:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .network-tab {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        
        .network-tab.active {
            border-bottom-color: var(--warm-gold);
            color: var(--warm-gold);
        }
        
        .metric-card {
            background: linear-gradient(135deg, rgba(74, 144, 226, 0.1) 0%, rgba(212, 175, 55, 0.1) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .position-row {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        .position-row:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .profit-positive {
            color: var(--success-green);
        }
        
        .profit-negative {
            color: #DC2626;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
        }

        .chart-box {
            height: 300px;

        }

        .chart-box-large {
            height: 400px;

        }

        /* =============================== */
        /* ESTILOS DE TARJETAS DEFI – FIDEFONDOS */
        /* =============================== */

        .vaults-section {
          padding: 3rem 1.5rem;
          background: radial-gradient(circle at top, #111827 0%, #020617 60%);
          color: #f9fafb;
        }

        .vaults-header {
          max-width: 960px;
          margin: 0 auto 2rem auto;
          text-align: center;
        }

        .vaults-header h1 {
          font-size: 2rem;
          margin-bottom: 0.5rem;
        }

        .vaults-header p {
          font-size: 0.95rem;
          opacity: 0.85;
        }

        .vaults-grid {
          max-width: 1120px;
          margin: 0 auto 2.5rem auto;
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
          gap: 1.5rem;
        }

        .vault-card {
          background: rgba(15, 23, 42, 0.95);
          border-radius: 1rem;
          border: 1px solid rgba(148, 163, 184, 0.4);
          padding: 1.5rem;
          box-shadow: 0 18px 45px rgba(15, 23, 42, 0.7);
          display: flex;
          flex-direction: column;
          gap: 0.75rem;
          cursor: pointer;
          transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
        }

        .vault-card:hover {
          transform: translateY(-4px);
          box-shadow: 0 22px 55px rgba(15, 23, 42, 0.9);
          border-color: #38bdf8;
        }

        .vault-name {
          font-size: 1.1rem;
          font-weight: 600;
        }

        .vault-risk {
          font-size: 0.8rem;
          text-transform: uppercase;
          letter-spacing: 0.08em;
          padding: 0.15rem 0.5rem;
          border-radius: 999px;
          display: inline-block;
        }

        .vault-risk.alto {
          background: rgba(248, 113, 113, 0.15);
          color: #fecaca;
        }

        .vault-risk.medio {
          background: rgba(252, 211, 77, 0.15);
          color: #fef3c7;
        }

        .vault-risk.bajo {
          background: rgba(52, 211, 153, 0.15);
          color: #bbf7d0;
        }

        .vault-address-row {
          font-size: 0.8rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 0.5rem;
          opacity: 0.9;
        }

        .vault-address-row code {
          font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
          font-size: 0.78rem;
          background: rgba(15, 23, 42, 0.9);
          padding: 0.35rem 0.55rem;
          border-radius: 999px;
        }

        .vault-copy-btn {
          font-size: 0.75rem;
          padding: 0.3rem 0.7rem;
          border-radius: 999px;
          border: 1px solid rgba(148, 163, 184, 0.7);
          background: transparent;
          color: #e5e7eb;
          cursor: pointer;
        }

        .vault-copy-btn:hover {
          background: rgba(148, 163, 184, 0.15);
        }

        .vault-metrics {
          display: flex;
          justify-content: space-between;
          gap: 1rem;
          margin-top: 0.3rem;
        }

        .vault-metric {
          display: flex;
          flex-direction: column;
          gap: 0.1rem;
        }

        .vault-metric-label {
          font-size: 0.75rem;
          opacity: 0.8;
        }

        .vault-metric-value {
          font-size: 1rem;
          font-weight: 600;
        }

        .vault-divider {
          margin: 0.75rem 0;
          border: 0;
          border-top: 1px dashed rgba(148, 163, 184, 0.4);
        }

        .vault-footer-row {
          display: flex;
          justify-content: space-between;
          align-items: center;
          font-size: 0.8rem;
          opacity: 0.9;
        }

        .vault-actions {
          display: flex;
          gap: 0.5rem;
        }

        .vault-btn {
          font-size: 0.8rem;
          padding: 0.4rem 0.9rem;
          border-radius: 999px;
          border: none;
          cursor: pointer;
        }

        .vault-btn.primary {
          background: linear-gradient(135deg, #22c55e, #10b981);
          color: #022c22;
          font-weight: 600;
        }

        .vault-btn.secondary {
          background: rgba(15, 23, 42, 0.9);
          color: #e5e7eb;
          border: 1px solid rgba(148, 163, 184, 0.7);
        }

        .vault-chart {
          max-width: 1120px;
          margin: 0 auto;
          background: rgba(15, 23, 42, 0.9);
          border-radius: 1rem;
          border: 1px solid rgba(148, 163, 184, 0.4);
          padding: 1.5rem;
        }

        .vault-chart h3 {
          margin-bottom: 0.75rem;
          font-size: 1rem;
        }

        @media (max-width: 640px) {
          .vault-metrics {
            flex-direction: column;
            align-items: flex-start;
          }

          .vault-footer-row {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.5rem;
          }
        }
        </style>
</head>
<body>
    <!-- Navegación -->
    <nav class="fixed top-0 w-full z-50 glass-effect">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold gradient-text">FideFondos DeFi</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-8">
                        <a href="index.html" class="text-white hover:text-yellow-400 transition-colors duration-300 font-medium">Inicio</a>
                        <a href="strategies.html" class="text-white hover:text-yellow-400 transition-colors duration-300 font-medium">Estrategias</a>
                        <a href="portfolio.html" class="text-yellow-400 font-medium">Portafolio</a>
                        <a href="about.html" class="text-white hover:text-yellow-400 transition-colors duration-300 font-medium">Nosotros</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-white hover:text-yellow-400" aria-label="Abrir menú de navegación" title="Abrir menú de navegación">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Menú móvil -->
        <div id="mobile-menu" class="md:hidden hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-black bg-opacity-50">
                <a href="index.html" class="text-white block px-3 py-2 hover:text-yellow-400">Inicio</a>
                <a href="strategies.html" class="text-white block px-3 py-2 hover:text-yellow-400">Estrategias</a>
                <a href="portfolio.html" class="text-yellow-400 block px-3 py-2">Portafolio</a>
                <a href="about.html" class="text-white block px-3 py-2 hover:text-yellow-400">Nosotros</a>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="pt-24 pb-16 bg-gradient-to-br from-gray-900 to-black">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h1 class="text-4xl md:text-6xl font-bold mb-6 gradient-text font-display">
                    Panel de Portafolio
                </h1>

                </h1>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    Visualizá tus inversiones DeFi en múltiples cadenas con análisis en tiempo real y métricas clave de rendimiento.
                </p>
            </div>
        </div>
    </section>

    <!-- SECCIÓN DE FONDOS DEFI -->
    <section class="vaults-section">
      <div class="vaults-header">
        <h1>Fondos DeFi FideFondos</h1>
        <p>Accede a estrategias DeFi en la red Base con control total desde tu propia billetera.</p>
      </div>

      <div class="vaults-grid" id="vaults-grid">
        <!-- Las tarjetas de cada fondo se generan con JavaScript -->
      </div>
    </section>

    <!-- Resumen principal -->
    <section class="py-16 bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Métricas -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-16">
                <div class="metric-card p-6 rounded-2xl text-center">
                    <div class="text-3xl font-bold gradient-text" id="total-value">$127,450</div>
                    <div class="text-sm text-gray-400 mt-2">Valor total del portafolio</div>
                    <div class="text-xs profit-positive mt-1">+12.5% (24h)</div>
                </div>
                <div class="metric-card p-6 rounded-2xl text-center">
                    <div class="text-3xl font-bold gradient-text" id="total-gain">+$15,230</div>
                    <div class="text-sm text-gray-400 mt-2">Ganancia / Pérdida total</div>
                    <div class="text-xs profit-positive mt-1">+13.6% histórico</div>
                </div>
                <div class="metric-card p-6 rounded-2xl text-center">
                    <div class="text-3xl font-bold gradient-text" id="avg-apy">16.8%</div>
                    <div class="text-sm text-gray-400 mt-2">APY promedio</div>
                    <div class="text-xs text-gray-500 mt-1">Promedio ponderado</div>
                </div>
                <div class="metric-card p-6 rounded-2xl text-center">
                    <div class="text-3xl font-bold gradient-text" id="active-positions">23</div>
                    <div class="text-sm text-gray-400 mt-2">Posiciones activas</div>
                    <div class="text-xs text-gray-500 mt-1">En 4 redes</div>
                </div>
            </div>
            
            <!-- Filtros por red -->
            <div class="flex flex-wrap gap-4 mb-8 justify-center">
                <button onclick="selectPortfolioNetwork('all')" id="portfolio-all" class="network-tab active px-6 py-3 bg-white bg-opacity-10 rounded-lg font-semibold">
                    Todas las redes
                </button>
                <button onclick="selectPortfolioNetwork('base')" id="portfolio-base" class="network-tab px-6 py-3 bg-white bg-opacity-10 rounded-lg font-semibold">
                    Base
                </button>
                <button onclick="selectPortfolioNetwork('arbitrum')" id="portfolio-arbitrum" class="network-tab px-6 py-3 bg-white bg-opacity-10 rounded-lg font-semibold">
                    Arbitrum
                </button>
                <button onclick="selectPortfolioNetwork('solana')" id="portfolio-solana" class="network-tab px-6 py-3 bg-white bg-opacity-10 rounded-lg font-semibold">
                    Solana
                </button>
                <button onclick="selectPortfolioNetwork('bnb')" id="portfolio-bnb" class="network-tab px-6 py-3 bg-white bg-opacity-10 rounded-lg font-semibold">
                    BNB Chain
                </button>
            </div>
        </div>
    </section>

    <!-- Gráficos -->
    <section class="py-16 bg-black bg-opacity-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid lg:grid-cols-2 gap-8 mb-16">
                <!-- Rendimiento del portafolio -->
                <div class="chart-container rounded-2xl p-6">
                    <h3 class="text-xl font-semibold mb-4">Rendimiento del portafolio</h3>
                    <div id="performance-chart" class="chart-box"></div>
                </div>
                
                <!-- Asignación de activos -->
                <div class="chart-container rounded-2xl p-6">
                    <h3 class="text-xl font-semibold mb-4">Asignación de activos</h3>
                    <div id="allocation-chart" class="chart-box"></div>
                </div>
            </div>
            
            <!-- Distribución por red -->
            <div class="chart-container rounded-2xl p-6 mb-16">
                <h3 class="text-xl font-semibold mb-4">Distribución de valor por red</h3>
                <div id="network-chart" class="chart-box-large"></div>
            </div>
        </div>
    </section>

    <!-- Tabla de posiciones -->
    <section class="py-16 bg-gray-900">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <h2 class="text-3xl font-bold mb-4 md:mb-0">Posiciones activas</h2>
                <div class="flex space-x-4">
                    <button onclick="exportPortfolio()" class="btn-primary px-6 py-3 rounded-lg font-semibold">
                        Exportar portafolio
                    </button>
                    <button onclick="refreshPortfolio()" class="border-2 border-blue-400 text-blue-400 hover:bg-blue-400 hover:text-white px-6 py-3 rounded-lg font-semibold transition-all duration-300">
                        Actualizar datos
                    </button>
                </div>
            </div>
            
            <div class="portfolio-card rounded-2xl overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-white bg-opacity-10">
                            <tr>
                                <th class="px-6 py-4 text-left">Protocolo</th>
                                <th class="px-6 py-4 text-left">Red</th>
                                <th class="px-6 py-4 text-right">Valor de la posición</th>
                                <th class="px-6 py-4 text-right">APY</th>
                                <th class="px-6 py-4 text-right">P&L</th>
                                <th class="px-6 py-4 text-center">Riesgo</th>
                                <th class="px-6 py-4 text-center">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="positions-table">
                            <!-- Posiciones cargadas dinámicamente -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Rendimiento de Yield Farming -->
    <section class="py-16 bg-black bg-opacity-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl font-bold mb-8 text-center">Rendimiento de Yield Farming</h2>
            
            <div class="grid md:grid-cols-3 gap-6 mb-12">
                <div class="metric-card p-6 rounded-2xl text-center">
                    <div class="text-2xl font-bold gradient-text">$8,420</div>
                    <div class="text-sm text-gray-400 mt-2">Fees totales generados</div>
                    <div class="text-xs profit-positive mt-1">+5.2% este mes</div>
                </div>
                <div class="metric-card p-6 rounded-2xl text-center">
                    <div class="text-2xl font-bold gradient-text">$2,150</div>
                    <div class="text-sm text-gray-400 mt-2">Recompensas reclamadas</div>
                    <div class="text-xs profit-positive mt-1">+8.7% este mes</div>
                </div>
                <div class="metric-card p-6 rounded-2xl text-center">
                    <div class="text-2xl font-bold gradient-text">12.3%</div>
                    <div class="text-sm text-gray-400 mt-2">APY promedio de fees</div>
                    <div class="text-xs text-gray-500 mt-1">En todos los pools</div>
                </div>
            </div>
            
            <!-- Gráfico de yield -->
            <div class="chart-container rounded-2xl p-6">
                <h3 class="text-xl font-semibold mb-4">Evolución del rendimiento de Yield Farming</h3>
                <div id="yield-chart" class="chart-box-large"></div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black bg-opacity-80 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h3 class="text-2xl font-bold gradient-text mb-4">FideFondos DeFi</h3>
                <p class="text-gray-400 mb-6">Gestión profesional de inversiones DeFi</p>
                <div class="flex justify-center space-x-8 mb-8">
                    <a href="index.html" class="text-gray-400 hover:text-yellow-400 transition-colors">Inicio</a>
                    <a href="strategies.html" class="text-gray-400 hover:text-yellow-400 transition-colors">Estrategias</a>
                    <a href="portfolio.html" class="text-yellow-400">Portafolio</a>
                    <a href="about.html" class="text-gray-400 hover:text-yellow-400 transition-colors">Nosotros</a>
                </div>
                <p class="text-gray-500 text-sm">
                    © 2025 FideFondos DeFi. Servicios profesionales de gestión de inversiones descentralizadas.
                </p>
            </div>
        </div>
    </footer>

     <!-- Scripts al final del body -->
    <script src="main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      // 1) Definimos los tres fondos
      const VAULTS = {
        base_fondo_anastacio_iii_2025: {
          id: "base_fondo_anastacio_iii_2025",
          name: "Fondo Base Anastacio III 2025",
          riskLevel: "Alto",
          riskClass: "alto",
          chainId: 8453,
          vaultAddress: "0x08cbdcd75b207b291089081838ba04988d402764",
          baseToken: "USDC",
          inceptionDate: "2025-11-10",
          performance: [
            { date: "2025-11-10", nav: 1.00 },
            { date: "2025-11-11", nav: 1.01 },
            { date: "2025-11-12", nav: 1.02 },
            { date: "2025-11-13", nav: 1.03 },
            { date: "2025-11-14", nav: 1.05 },
            { date: "2025-11-15", nav: 1.06 },
            { date: "2025-11-16", nav: 1.07 },
            { date: "2025-11-17", nav: 1.08 }
          ]
        },
        fondo_conservador_anastacio_vi: {
          id: "fondo_conservador_anastacio_vi",
          name: "Fondo Conservador Anastacio VI",
          riskLevel: "Medio",
          riskClass: "medio",
          chainId: 8453,
          vaultAddress: "0x30148f7648eeacb01b502767dfab449a3485bbb4",
          baseToken: "USDC",
          inceptionDate: "2025-11-05",
          performance: [
            { date: "2025-11-10", nav: 1.00 },
            { date: "2025-11-11", nav: 1.003 },
            { date: "2025-11-12", nav: 1.006 },
            { date: "2025-11-13", nav: 1.009 },
            { date: "2025-11-14", nav: 1.012 },
            { date: "2025-11-15", nav: 1.015 },
            { date: "2025-11-16", nav: 1.018 },
            { date: "2025-11-17", nav: 1.020 }
          ]
        },
        fondo_bluechips_anastacio_vi_2025: {
          id: "fondo_bluechips_anastacio_vi_2025",
          name: "Fondo Blue Chips Anastacio VI 2025",
          riskLevel: "Bajo",
          riskClass: "bajo",
          chainId: 8453,
          vaultAddress: "0xe5d1377eca29f30065716f99a439f923f6bedb7b",
          baseToken: "USDC",
          inceptionDate: "2025-11-01",
          performance: [
            { date: "2025-11-10", nav: 1.00 },
            { date: "2025-11-11", nav: 1.001 },
            { date: "2025-11-12", nav: 1.002 },
            { date: "2025-11-13", nav: 1.003 },
            { date: "2025-11-14", nav: 1.004 },
            { date: "2025-11-15", nav: 1.005 },
            { date: "2025-11-16", nav: 1.006 },
            { date: "2025-11-17", nav: 1.007 }
          ]
        }
      };

      // 2) Cálculo de ROI y APR
      function computeStats(vault) {
        const points = vault.performance;
        if (!points || points.length < 2) {
          return { roi: 0, apr: 0, days: 0 };
        }

        const first = points[0];
        const last = points[points.length - 1];

        const start = new Date(first.date);
        const end = new Date(last.date);
        const diffMs = end - start;
        const days = Math.max(1, diffMs / (1000 * 60 * 60 * 24));

        const roi = (last.nav / first.nav - 1) * 100;
        const apr = roi * (365 / days);

        return { roi, apr, days };
      }

      // 3) Copiar dirección
      function copyToClipboard(text) {
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text);
        } else {
          const tmp = document.createElement("textarea");
          tmp.value = text;
          document.body.appendChild(tmp);
          tmp.select();
          document.execCommand("copy");
          document.body.removeChild(tmp);
        }
      }

      // 4) Gráfico
      let vaultChart = null;

      function renderChart(vault) {
        const canvas = document.getElementById("vault-chart-canvas");
        if (!canvas) return;
        const ctx = canvas.getContext("2d");

        const labels = vault.performance.map(p => p.date);
        const data = vault.performance.map(p => p.nav);

        if (vaultChart) {
          vaultChart.destroy();
        }

        vaultChart = new Chart(ctx, {
          type: "line",
          data: {
            labels,
            datasets: [{
              label: "NAV (USDC)",
              data,
              tension: 0.3
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false }
            },
            scales: {
              x: {
                ticks: { color: "#e5e7eb" },
                grid: { color: "rgba(55,65,81,0.4)" }
              },
              y: {
                ticks: { color: "#e5e7eb" },
                grid: { color: "rgba(55,65,81,0.4)" }
              }
            }
          }
        });

        const chartTitle = document.getElementById("chart-title");
        if (chartTitle) {
          chartTitle.textContent = `Rendimiento histórico – ${vault.name}`;
        }
      }

      // 5) Tarjetas
      function renderVaultCards() {
        const grid = document.getElementById("vaults-grid");
        if (!grid) return;

        grid.innerHTML = "";

        Object.values(VAULTS).forEach(vault => {
          const stats = computeStats(vault);

          const card = document.createElement("article");
          card.className = "vault-card";
          card.dataset.vaultId = vault.id;

          card.innerHTML = `
            <div>
              <div class="vault-name">${vault.name}</div>
              <span class="vault-risk ${vault.riskClass}">${vault.riskLevel}</span>
            </div>

            <div class="vault-address-row">
              <span>Contrato:</span>
              <code>${vault.vaultAddress.slice(0, 6)}...${vault.vaultAddress.slice(-4)}</code>
              <button class="vault-copy-btn" type="button">Copiar</button>
            </div>

            <div class="vault-metrics">
              <div class="vault-metric">
                <span class="vault-metric-label">ROI desde inicio</span>
                <span class="vault-metric-value">${stats.roi.toFixed(2)}%</span>
              </div>
              <div class="vault-metric">
                <span class="vault-metric-label">APR estimado</span>
                <span class="vault-metric-value">${stats.apr.toFixed(2)}%</span>
              </div>
            </div>

            <hr class="vault-divider" />

            <div class="vault-footer-row">
              <span>Desde: ${vault.inceptionDate}</span>
              <div class="vault-actions">
                <button class="vault-btn secondary" type="button">Retirar</button>
                <button class="vault-btn primary" type="button">Depositar</button>
              </div>
            </div>
          `;

          // Click en la tarjeta → actualizar gráfico
          card.addEventListener("click", (e) => {
            if (e.target && e.target.classList.contains("vault-copy-btn")) return;
            renderChart(vault);
          });

          // Botón copiar
          const copyBtn = card.querySelector(".vault-copy-btn");
          if (copyBtn) {
            copyBtn.addEventListener("click", (e) => {
              e.stopPropagation();
              copyToClipboard(vault.vaultAddress);
            });
          }

          grid.appendChild(card);
        });
      }

      // 6) Inicialización
      document.addEventListener("DOMContentLoaded", () => {
        renderVaultCards();

        const defaultVault = VAULTS.base_fondo_anastacio_iii_2025;
        if (defaultVault) {
          renderChart(defaultVault);
        }
      });
    </script>
  </body>
</html>

